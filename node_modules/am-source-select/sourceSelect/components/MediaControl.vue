<template>
    <div class="media-control" :class="controlStatus">
        <div class="progress-box">
            <!-- <el-slider v-model="currentTime" 
            @input="progressChangeHandler(this,$event)"
            :min="0"
            :max="duration"></el-slider> -->
            <MySlider :value="progressValue" :hiddenKey="controlStatus=='easy'" @value_change="value_changeHandler"/>
        </div>
        <div class="control-btns">
            <div class="cb-left">
                <div class="cb-btn btn-play" v-if="isPause" @click="playHandler">
                    <svg width="200px" height="200.00px" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"><path fill="#333333" d="M173.941762 1024C102.058122 1024 51.014197 966.177965 51.014197 887.159472V136.751343C51.014197 57.970678 103.187807 0 173.941762 0A150.248106 150.248106 0 0 1 250.492786 22.028858l649.420235 374.579764c46.406271 26.755697 73.072783 68.375671 73.072782 114.811671s-26.755697 88.145159-73.072782 114.811671l-649.420235 374.579765a151.615619 151.615619 0 0 1-76.551024 23.188271z" /></svg>
                </div>
                <div class="cb-btn btn-pause" v-if="!isPause" @click="pauseHandler">
                    <svg width="200px" height="200.00px" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"><path fill="#333333" d="M768.255475 0a112.588489 112.588489 0 0 0-109.912589 109.711897v804.375514a109.912589 109.912589 0 0 0 219.825178 0V109.644999A112.588489 112.588489 0 0 0 768.255475 0zM255.553052 0A112.588489 112.588489 0 0 0 145.640463 109.711897v804.375514a109.912589 109.912589 0 0 0 219.825178 0V109.644999A112.722284 112.722284 0 0 0 255.553052 0z" /></svg>
                </div>
                <div class="cb-time">
                    <span>{{curTimeStr}}</span>
                    <span>/</span>
                    <span>{{durTimeStr}}</span>
                </div>
            </div>
            <div class="cb-right">
                <div class="cb-btn btn-volume" @mouseover="vbtn_mouseover" @mouseout="vbtn_mouseout">
                    <div class="cb-btn-click"  @click="muteClickHandler">
                        <svg v-if="volumeStatus=='level0'" width="200px" height="200.00px" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"><path fill="#333333" d="M530.7 99.4c-12.3 0-17.7 0-33.7 4.3-16 4.3-213.1 172.5-213.1 172.5h-101c-60.5 0-110 49.5-110 110v227c0 60.5 49.5 110 110 110h101s222.6 184.6 228.9 187.2c4.9 2 9.3 5.3 20.4 2 6.7-2 29.1-30.7 29.1-48.6 0-0.1-0.3-695.1-1-715.1S543 99.4 530.7 99.4z m-54.9 682.3l-158.5-139H183.1c-16.5 0-29.9-13.5-29.9-29.9V386.6c0-16.5 13.5-29.9 29.9-29.9h128.7l164.5-136-0.5 561zM865.5 506.6l92.6-92.6c15.8-15.8 15.8-41.7 0-57.5-15.8-15.8-41.7-15.8-57.5 0L808 449.1l-92.6-92.6c-15.8-15.8-41.7-15.8-57.5 0-15.8 15.8-15.8 41.7 0 57.5l92.6 92.6-92.5 92.6c-15.8 15.8-15.8 41.7 0 57.5 15.8 15.8 41.7 15.8 57.5 0l92.6-92.6 92.6 92.6c15.8 15.8 41.7 15.8 57.5 0 15.8-15.8 15.8-41.7 0-57.5l-92.7-92.6z" /></svg>
                        <svg v-if="volumeStatus=='level1'" width="200px" height="200.00px" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"><path fill="#333333" d="M530.688 99.328c-12.288 0-17.664 0-33.792 4.352-16.128 4.352-212.992 172.544-212.992 172.544H182.784c-60.416 0-110.08 49.408-110.08 110.08v227.072c0 60.416 49.408 110.08 110.08 110.08h101.12s222.72 184.576 228.864 187.136c4.864 2.048 9.216 5.376 20.48 2.048 6.656-2.048 29.184-30.72 29.184-48.64 0 0-0.256-695.04-1.024-715.008-0.768-20.224-18.432-49.664-30.72-49.664z m-54.784 682.496L317.44 642.816H183.04c-16.384 0-29.952-13.568-29.952-29.952V386.56c0-16.384 13.568-29.952 29.952-29.952h128.768l164.608-135.936-0.512 561.152z" /></svg>
                        <svg v-if="volumeStatus=='level2'" width="200px" height="200.00px" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"><path fill="#333333" d="M530.688 99.328c-12.288 0-17.664 0-33.792 4.352-16.128 4.352-212.992 172.544-212.992 172.544H182.784c-60.416 0-110.08 49.408-110.08 110.08v227.072c0 60.416 49.408 110.08 110.08 110.08h101.12s222.72 184.576 228.864 187.136c4.864 2.048 9.216 5.376 20.48 2.048 6.656-2.048 29.184-30.72 29.184-48.64 0 0-0.256-695.04-1.024-715.008-0.768-20.224-18.432-49.664-30.72-49.664z m-54.784 682.496L317.44 642.816H183.04c-16.384 0-29.952-13.568-29.952-29.952V386.56c0-16.384 13.568-29.952 29.952-29.952h128.768l164.608-135.936-0.512 561.152z m177.408-467.712c-22.016 0-39.936 17.92-39.936 39.936 0 7.68 2.304 15.104 6.144 21.248l-0.256 0.256c25.088 37.632 39.68 80.896 39.68 129.536 0 46.336-13.312 91.904-36.096 128.256a39.424 39.424 0 0 0-9.472 25.6c0 22.016 17.92 39.936 39.936 39.936 15.104 0 28.16-8.192 35.072-20.48l0.512 0.256c31.744-49.408 50.176-110.592 50.176-173.824 0-62.72-18.176-118.784-49.408-167.936-6.656-13.312-20.48-22.784-36.352-22.784z" /></svg>
                        <svg v-if="volumeStatus=='level3'" width="200px" height="200.00px" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"><path fill="#333333" d="M530.7 99.4c-12.3 0-17.7 0-33.7 4.3-16 4.3-213.1 172.5-213.1 172.5h-101c-60.5 0-110 49.5-110 110v227c0 60.5 49.5 110 110 110h101s222.6 184.6 228.9 187.2c4.9 2 9.3 5.3 20.4 2 6.7-2 29.1-30.7 29.1-48.6 0-0.1-0.3-695.1-1-715.1S543 99.4 530.7 99.4z m-54.9 682.3l-158.5-139H183.1c-16.5 0-29.9-13.5-29.9-29.9V386.6c0-16.5 13.5-29.9 29.9-29.9h128.7l164.5-136-0.5 561zM653.3 314.1c-22.1 0-40 17.9-40 40 0 7.8 2.2 15 6.1 21.2l-0.3 0.2c25.1 37.7 39.8 80.8 39.8 129.6 0 46.3-13.3 91.8-36.2 128.3-5.8 7-9.4 15.9-9.4 25.7 0 22.1 17.9 40 40 40 15.1 0 28.2-8.3 35-20.6l0.4 0.2c31.7-49.5 50.2-110.5 50.2-173.7 0-62.6-18.1-118.8-49.3-168-6.5-13.5-20.3-22.9-36.3-22.9zM844.9 180.5l-0.3 0.2c-7.1-10.9-19.5-18.1-33.4-18.1-22.1 0-40 17.9-40 40 0 9.8 3.5 18.7 9.4 25.7 51.3 79 81 175.4 81 276.6 0 104.8-32 200-86.6 280.7-5.5 6.8-8.8 15.5-8.8 25 0 22.1 17.9 40 40 40 14.8 0 27.6-8 34.6-19.9l0.2 0.1c63.5-93.6 100.6-204.3 100.6-325.9 0-119-35.6-232-96.7-324.4z" /></svg>
                    </div>
                    <el-slider class="volume-slider" v-show="showVolumeSlider" vertical height="100px" v-model="volume" :min="0" :max="1" :step="0.01"
                    :format-tooltip="formatTooltipSlider"
                    @input="volumeChangeHandler"
                    tooltip-class="volume-slider-tooltip"></el-slider>
                </div>
            </div>
        </div>
    </div>
</template>

<script>
import MySlider from './MySlider';
import Utils from '../../libs/Utils.js'
export default {
    components:{MySlider},
    props:{
        isPause:{
            type:Boolean,
            default: false
        },
        controlStatus:{
            type:String,
            default:'easy'
        }
    },
    data(){
        return {
            currentTime:0,
            duration:0,
            volume:1,
            recordVolume:1,
            isMute:false,
            // curTimeStr:'00:00:00',
            // durTimeStr:'00:00:00',
            showVolumeSlider: false,
            progressValue:0,//0-1
        }
    },
    computed:{
        volumeStatus(){
            if(this.volume === 0) return 'level0';
            if(this.volume <= 0.2) return 'level1';
            if(this.volume <= 0.6) return 'level2';
            return 'level3';
        },
        curTimeStr(){
            return Utils.getFormatHMS(this.currentTime*1000);
        },
        durTimeStr(){
            return Utils.getFormatHMS(this.duration*1000);
        }
    },
    methods:{
        setCurrentTime(v){
            this.currentTime = v;
            this.progressValue = this.duration == 0?0:(v/this.duration);
        },
        setDuration(v){
            this.duration = v;
        },
        setVoume(v){
            this.volume = v;
        },
        vbtn_mouseover(){
            this.showVolumeSlider = true;
        },
        vbtn_mouseout(){
            this.showVolumeSlider = false;
        },
        formatTooltipSlider(value){
            return Math.floor(value*100) + '%'
        },
        volumeChangeHandler(v){
            this.isMute = v==0;
            this.$emit('volume-change',v);
        },
        playHandler(){
            this.$emit('play');
        },
        pauseHandler(){
            this.$emit('pause');
        },
        value_changeHandler(v){
            // console.log('value_changeHandler',v,event)

            this.$emit('seek',v*this.duration);
        },
        muteClickHandler(){
            this.isMute = !this.isMute;
            if(this.isMute){
                this.recordVolume = this.volume;
                this.volume = 0;
            }else{
                this.volume = this.recordVolume || 0.5;
            }
            this.$emit('volume_change',this.volume);
        }
    }
}
</script>


<style lang="scss" scoped>
.media-control{
    width: 100%;
    height: 60px;
    background-color: rgba(0,0,0,0.5);
    position: absolute;
    bottom: 0;
    z-index: 5;
    user-select: none;

    .progress-box{
        width: calc(100% - 30px);
        height: 3px;
        position: absolute;
        left: 15px;
        top: 15px;
        z-index: 1;
    }

    .control-btns{
        width: 100%;
        height: calc(100% - 20px);
        position: relative;
        top: 20px;
        // position: absolute;
        // top: 15px;
        display: flex;
        z-index: 2;
        
        .cb-left{
            display: flex;
            align-items: center;
            padding-left: 5px;
            flex: 1;
            font-size: 14px;
            color: #ffffff;
        }
        .cb-right{
            width: 40px;
            display: flex;
            align-items: center;
        }

        .cb-btn{
            width: 30px;
            height: 30px;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;

            svg{
                width: 22px;
                height: 22px;

                path{
                    fill: #ffffff;
                }
            }

            &:hover{
                // background-position-x: -30px;
                // color: #bdbdbd;
                path{
                    fill: #bdbdbd;
                }
            }
        }
        .btn-play,.btn-pause{
            svg{
                width: 14px;
                height: 14px;
            }
        }
        
        .btn-volume{
            position: relative;
            color: #ffffff;
            font-size: 24px;
            

            .volume-slider{
                position: absolute;
                bottom: 30px;
                left: -6px;
            }
        }
    }
}
.media-control.easy{
    height: 3px;
    .progress-box{
        height: 3px;
        width: 100%;
        height: 3px;
        position: absolute;
        left: 0px;
        top: initial;
    }
    .control-btns{
        display: none;
    }
}
</style>